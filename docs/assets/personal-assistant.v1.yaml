openapi: 3.0.3
info:
  title: Personal Assistant
  description: >
    API for managing and searching personal media collections including books,
    videos, preferences and notes resources.

    When updating or creating resources, ONLY provide the fields you want to
    change and DO NOT send read-only fields.

    Query Filters are provided for all children resources, but if a param is
    provided that is not valid for a given resource

    it will be ignored.

      ### Query Operators

      The API supports the following operators for filtering:

      | Operator      | Description                                                                 | Example                                      |
      |---------------|-----------------------------------------------------------------------------|----------------------------------------------|
      | `eq.<value>`  | Equals the specified value.                                                  | `"userRating": "eq.5"` → books with rating 5 |
      | `neq.<value>` | Not equal to the specified value.                                           | `"author": "neq.Unknown"`                    |
      | `gt.<number>` | Greater than (for numeric values).                                          | `"userRating": "gt.7"`                       |
      | `lt.<number>` | Less than (for numeric values).                                             | `"userRating": "lt.3"`                       |
      | `gte.<number>`| Greater than or equal to.                                                   | `"userRating": "gte.8"`                      |
      | `lte.<number>`| Less than or equal to.                                                      | `"userRating": "lte.2"`                      |
      | `isNull`      | Returns items where the field is missing, empty, or null.                   | `"isbnId": "isNull"` → books without ISBNs   |
      | `*` (wildcard)| Matches partial values (supports leading/trailing wildcards).                | `"title": "*Survivor*"` → titles containing “Survivor” |

      ### Examples

      - **Books without an ISBN**
        ```json
        { "isbnId": "isNull" }
        ```

      - **Audiobooks with no narrator listed**
        ```json
        { "narrator": "isNull" }
        ```

      - **Titles missing genre information**
        ```json
        { "genres": "isNull" }
        ```
  termsOfService: https://developer.acme.com/terms/
  contact:
    name: acme API Gov Team
    email: API-Gov-Team@gmail.com
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  version: v1
externalDocs:
  description: Find out more about acme API Products
  url: https://developer.acme.com
servers:
  - url: https://myserver.amazonaws.com
security:
  - bearerAuth: []
paths:
  /v1/resources:
    get:
      tags:
        - Personal-Assistant
      summary: List user resources
      description: List user resources
      operationId: getResources
      parameters:
        - name: ids
          in: query
          description: Unique identifier for the resource.
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
              format: uuid
        - name: limit
          in: query
          description: Maximum number of items to return.
          required: false
          style: form
          explode: true
          schema:
            maximum: 2000
            minimum: 1
            type: integer
        - name: offset
          in: query
          description: Number of items to skip before starting to collect the result set.
          required: false
          style: form
          explode: true
          schema:
            maximum: 1000000
            minimum: 0
            type: integer
        - name: order
          in: query
          description: Sort order for the results (e.g., order=title.asc).
          required: false
          style: form
          explode: true
          schema:
            pattern: ^[A-Za-z0-9_]+\.(asc|desc)$
            type: string
      responses:
        '200':
          description: >-
            A list of resources The response also includes a Content-Range
            header in the format 'items start-end/total', which provides the
            total record count.
          headers:
            Content-Range:
              $ref: '#/components/headers/ContentRange'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Resources'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ErrorItem'
        '401':
          description: Unauthorized search request.
        '403':
          description: Forbidden - The request is understood but access is not permitted.
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ErrorItem'
        '429':
          description: Too Many Requests
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      tags:
        - Personal-Assistant
      summary: Create resources in bulk
      description: Create multiple resource records
      operationId: createResources
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 1000
              minItems: 1
              type: array
              items:
                $ref: '#/components/schemas/Resource'
        required: true
      responses:
        '201':
          description: Resources created successfully in bulk
          headers:
            Content-Range:
              $ref: '#/components/headers/ContentRange'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Resources'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ErrorItem'
        '401':
          description: Unauthorized search request.
        '403':
          description: Forbidden - The request is understood but access is not permitted.
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ErrorItem'
        '429':
          description: Too Many Requests
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - Personal-Assistant
      summary: Delete resources
      description: Remove a user resource from your settings
      operationId: deleteResources
      parameters:
        - name: resourceType
          in: query
          description: Resource type
          required: true
          style: form
          explode: true
          schema:
            $ref: '#/components/schemas/ResourceType'
        - name: category
          in: query
          description: Filter by category (supports wildcard and partial matches).
          required: false
          style: form
          explode: true
          schema:
            maxLength: 40
            minLength: 1
            pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
            type: string
        - name: ids
          in: query
          description: Unique identifier for the resource.
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
              format: uuid
        - name: id
          in: query
          description: Unique identifier for the resource.
          required: false
          style: form
          explode: true
          schema:
            type: string
            format: uuid
        - name: dueDateTime
          in: query
          description: >-
            Due date for the resource (ISO 8601 format). Only applicable for
            tasks resource.
          required: false
          style: form
          explode: true
          schema:
            pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
            type: string
      responses:
        '200':
          description: >-
            A list of resources The response also includes a Content-Range
            header in the format 'items start-end/total', which provides the
            total record count.
          headers:
            Content-Range:
              $ref: '#/components/headers/ContentRange'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Resources'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ErrorItem'
        '401':
          description: Unauthorized search request.
        '403':
          description: Forbidden - The request is understood but access is not permitted.
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ErrorItem'
        '429':
          description: Too Many Requests
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      tags:
        - Personal-Assistant
      summary: Update resources
      description: >-
        Update multiple resources in your personal library. Only need to provide
        those fields that need to be updated. ResourceType valid values are
        'UpdateBook', 'UpdateVideo', 'UpdatePreference', 'UpdateNote'.
      operationId: updateResources
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 1000
              minItems: 1
              type: array
              items:
                $ref: '#/components/schemas/Resource'
        required: true
      responses:
        '200':
          description: Updated successfully
          headers:
            Content-Range:
              $ref: '#/components/headers/ContentRange'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Resources'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ErrorItem'
        '401':
          description: Unauthorized search request.
        '403':
          description: Forbidden - The request is understood but access is not permitted.
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ErrorItem'
        '429':
          description: Too Many Requests
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
components:
  schemas:
    Calendar:
      required:
        - resourceType
      type: object
      properties:
        id:
          $ref: '#/components/schemas/Id'
        resourceType:
          type: string
          enum:
            - Calendar
          x-query: required
        isActive:
          type: boolean
          x-query: optional
        category:
          maxLength: 40
          minLength: 1
          pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?-]+$
          type: string
          description: The category or group this note belongs to
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        name:
          maxLength: 40
          minLength: 1
          pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?-]+$
          type: string
          description: The name of the calendar
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        url:
          maxLength: 500
          minLength: 1
          pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?/-]+$
          type: string
          description: The public URL for the calendar - must be a valid ics URL
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?/*-]+$
      description: A calendar entry - ics URL - to be added to tasks
      x-context:
        required:
          post:
            - category
            - category
            - name
            - url
          put:
            - category
            - category
            - name
            - url
          delete:
            - id
          patch:
            - id
        prohibited:
          post:
            - id
          put:
            - id
    ContentRange:
      type: string
      description: The content range of the response
      example: items 0-24/100
    Error:
      type: object
      properties:
        code:
          maximum: 99999
          minimum: 10000
          type: integer
          description: Error Code
        message:
          type: string
          description: Error message from service
    ErrorItem:
      type: object
      properties:
        objectName:
          type: string
          description: Name of the object containing the field that is in error
        field:
          type: string
          description: Name of the field in error
        rejectedValue:
          type: string
          description: Value that caused the error
        code:
          maximum: 99999
          minimum: 10000
          type: integer
          description: Error Code
        message:
          type: string
          description: Error message from service
    Id:
      type: string
      description: Unique identifier for this resource
      format: uuid
      x-query: optional
      x-primary-key: true
      x-query-pattern: >-
        ^(eq\.|neq\.)[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$|^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$|^isNull$
    Note:
      required:
        - resourceType
      type: object
      properties:
        id:
          $ref: '#/components/schemas/Id'
        resourceType:
          type: string
          enum:
            - Note
          x-query: required
        category:
          maxLength: 40
          minLength: 1
          pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?-]+$
          type: string
          description: The category or group this note belongs to
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        subject:
          maxLength: 40
          minLength: 1
          pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?-]+$
          type: string
          description: The name of the note setting
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        note:
          maxLength: 500
          minLength: 1
          pattern: ^[A-Za-z0-9._,+:;'|→/#%$&@\s()#!?*-]+$
          type: string
          description: The new value for this note
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:;'|→/#%$&@\s()#!?*-]+$
      description: A user note or configuration setting
      x-context:
        required:
          post:
            - category
            - subject
            - note
          put:
            - category
            - subject
            - note
          delete:
            - id
          patch:
            - id
        prohibited:
          post:
            - id
          put:
            - id
    Preference:
      required:
        - resourceType
      type: object
      properties:
        id:
          $ref: '#/components/schemas/Id'
        resourceType:
          type: string
          enum:
            - Preference
          x-query: required
        category:
          maxLength: 40
          minLength: 1
          pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?-]+$
          type: string
          description: The category or group this preference belongs to
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        name:
          maxLength: 40
          minLength: 1
          pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?-]+$
          type: string
          description: The name of the preference setting
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        value:
          maxLength: 200
          minLength: 1
          type: string
          description: The new value for this preference
          x-query: optional
          x-query-pattern: >-
            ^(eq\.|neq\.)[A-Za-z0-9._,+:'|&@\s()#!?-]+$|^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$|^isNull$
        isPii:
          type: boolean
          description: Whether this preference contains personally identifiable information
          x-query: optional
          x-query-pattern: ^(eq\.|neq\.)(true|false)$|^(true|false)$|^isNull$
        expiresAtDateTime:
          type: string
          description: When this preference should expire (if applicable)
          format: date-time
          x-query: optional
          x-query-pattern: >-
            ^(gt\.|lt\.|gte\.|lte\.|eq\.|neq\.)[0-9T:\-Z]+$|^[0-9T:\-Z]+$|^isNull$
      description: A user preference or configuration setting
      x-context:
        required:
          post:
            - category
            - name
            - value
          put:
            - category
            - name
            - value
          delete:
            - id
          patch:
            - id
        prohibited:
          post:
            - id
          put:
            - id
    Resource:
      discriminator:
        propertyName: resourceType
      oneOf:
        - $ref: '#/components/schemas/Calendar'
        - $ref: '#/components/schemas/Note'
        - $ref: '#/components/schemas/Preference'
        - $ref: '#/components/schemas/Task'
    ResourceType:
      type: string
      description: The type of resource this is
      enum:
        - Book
        - Calendar
        - Note
        - Preference
        - Task
        - Video
    Resources:
      type: object
      properties:
        contentRange:
          $ref: '#/components/schemas/ContentRange'
        results:
          maxItems: 1000
          minItems: 0
          type: array
          description: The list of resources
          items:
            $ref: '#/components/schemas/Resource'
      readOnly: true
    Task:
      required:
        - resourceType
      type: object
      properties:
        id:
          $ref: '#/components/schemas/Id'
        resourceType:
          type: string
          enum:
            - Task
          x-query: required
        providerId:
          type: string
          description: External provider identifier
        providerTaskListId:
          type: string
          description: External provider task list ID
        parentId:
          type: string
          description: Parent task UUID for subtasks
          format: uuid
          x-query: optional
        dueDateTime:
          type: string
          description: The due date and time for the task
          format: date-time
          nullable: true
          x-query: optional
        completed:
          type: boolean
          description: Whether the task is completed
          default: false
          x-query: optional
        category:
          maxLength: 100
          pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?-]+$
          type: string
          description: The category
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        title:
          maxLength: 255
          type: string
          description: The title of the task
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        course:
          maxLength: 255
          type: string
          description: The course or project this task is associated with
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        calendarSource:
          maxLength: 255
          type: string
          description: which calendar this task was sourced from (if any)
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        notes:
          maxLength: 500
          type: string
          description: Additional notes for the task
          x-query: optional
          x-query-pattern: ^[A-Za-z0-9._,+:'|&@\s()#!?*-]+$
        url:
          maxLength: 500
          type: string
          description: The URL associated with the task
          x-query: optional
      description: >-
        List of tasks - can be added to manually by user or is populated by
        pulling the calendar events.
      x-context:
        required:
          post:
            - resourceType
            - dueDateTime
            - title
          put:
            - id
            - resourceType
            - dueDateTime
            - title
          delete:
            - id
          patch:
            - id
        prohibited:
          post:
            - id
  headers:
    ContentRange:
      description: Total count of items matching the filter criteria
      schema:
        type: string
        example: 0-700/*
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
